<!-- 
      Spectrum.html
      A custom element color picker with an API to get and set color of the
      color picker. 
-->

<script src="./DOMExtension.js"></script>
<script src="./WebInspector.js"></script>
<script src="./Object.js"></script>
<script src="./View.js"></script>
<script src="./Popover.js"></script>
<script src="./Color.js"></script>
<script src="./Spectrum.js"></script>

<template id="spectrum-swatch-template">
  <style>
    .swatch {
        margin-left: 1px;
        margin-right: 2px;
        width: 10px;
        height: 10px;
        position: relative;
        top: 1px;
        display: inline-block;
        background-image: url(Images/checker.png);
        -webkit-user-select: none;
    }

    .swatch-inner {
        width: 100%;
        height: 100%;
        display: inline-block;
        border: 1px solid rgba(128, 128, 128, 0.6);
    }

    .swatch-inner:hover {
        border: 1px solid rgba(64, 64, 64, 0.8);
    }
  </style>
  <nobr>
    <span title="Mouseover txt..." class="swatch">
      <span class="swatch-inner" style="background-color: rgb(22, 26, 34);"></span>
    </span>
    <span>#161a22</span>
  </nobr>
</template>

<template id="spectrum-popover-template">
  <style>
    @import url("spectrum.css")
  </style>
</template>

<template id="color-picker-template">
  <style>
    @import url("spectrum.css")
  </style>
</template>

<script>
  var importDoc = document.currentScript.ownerDocument;

  // The color picker
  var colorPickerPrototype = Object.create(HTMLElement.prototype, {
    createdCallback: {
      value: function() {
        var t = importDoc.querySelector('#color-picker-template');
        var clone = document.importNode(t.content, true);
        var root = this.createShadowRoot(); 
        root.appendChild(clone);

        console.log('Successfully stamped out color-picker!');
      }
    }
  });
  document.registerElement('color-picker', {prototype: colorPickerPrototype});

  // The swatch
  var spectrumSwatchPrototype = Object.create(HTMLElement.prototype, {
    createdCallback: {
      value: function() {
        var t = importDoc.querySelector('#spectrum-swatch-template');
        var clone = document.importNode(t.content, true);
        var root = this.createShadowRoot(); 
        root.appendChild(clone);

        console.log('Successfully stamped out spectrum-swatch!');
      }
    }
  });
  document.registerElement('spectrum-swatch', {prototype:
    spectrumSwatchPrototype});

  // The popover
  var spectrumPopoverPrototype = Object.create(HTMLElement.prototype, {
    createdCallback: {
      value: function() {
        var t = importDoc.querySelector('#spectrum-popover-template');
        var clone = document.importNode(t.content, true);
        var root = this.createShadowRoot(); 
        root.appendChild(clone);

        this.Spectrum = new Spectrum();
        root.appendChild(this.Spectrum.element);

        console.log('Successfully stamped out spectrum-popover!');
      }
    }
  });
  document.registerElement('spectrum-popover', {prototype: spectrumPopoverPrototype});

  console.log(WebInspector);
 
</script>
